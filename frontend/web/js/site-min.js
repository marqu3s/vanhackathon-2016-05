function checkPlayer(){""===token?$("#divLogin").removeClass("hidden").addClass("animated fadeIn"):$("#divNewGameJoinGame").removeClass("hidden").addClass("animated fadeIn")}function updateGameRoom(a){$("#divGameRoom").load("/site/ajax-update-game-room",{id:a},function(){$("#divGamesList").removeClass("animated slideInLeft fadeIn").addClass("hidden"),$(this).removeClass("hidden").addClass("animated slideInLeft")})}function updateGameBoard(a){updateGameRoom(a),$("#divGameBoard").load("/site/ajax-get-game-board",{idGame:a},function(){$(this).removeClass("hidden").addClass("animated fadeIn")})}function startGame(a){console.log("Starting game "+a),$("#divGameRoom").addClass("hidden").removeClass("animated slideInLeft"),updateGameBoard(a)}function subscribePlayer(a){socket.emit("subscribe","game"+a),socket.on("game"+a,function(a){var e;try{e=JSON.parse(a)}catch(t){e=a}console.log(e),"startgame"===e.task?startGame(e.idGame):"update-room"===e.task?updateGameRoom(e.idGame):"update-board"===e.task?updateGameBoard(e.idGame):"all-players-ready"===e.task?(updateGameBoard(e.idGame),$("#btnSubmitGuess").show(),$("#btnSubmitGuessMsg").hide()):"player-joinned-game"===e.task&&updateGameRoom(e.idGame)}),console.log("Player subscribed to channel: game"+a)}function createNewGame(){$.ajax({url:"/site/ajax-host-game",type:"post",dataType:"json",data:{secret_size:$("#secret_size").val()},success:function(a){$("#divGameSettings").addClass("hidden").removeClass("animated fadeIn"),subscribePlayer(a.id_game),updateGameRoom(a.id_game),console.log("Player "+token+" joinned game "+a.id_game)}})}function joinExistingGame(){$("#divGamesList").load("/site/ajax-games-list",function(){$(this).removeClass("slideInLeft fadeIn").removeClass("hidden").addClass("animated slideInLeft")}),$("#divGameRoom").addClass("hidden")}function joinThisGame(a){subscribePlayer(a),$.post("/site/ajax-join-game",{idGame:a},function(a){})}function setPlayerStatus(a,e,t){$.ajax({type:"post",url:"/site/ajax-set-player-status",data:{idGame:a,idPlayer:e,status:t},complete:function(e){updateGameRoom(a)}})}function submitGuess(a,e){var t=[];return $(".color-picker").each(function(a,e){""!==$(e).val()&&t.push($(e).val())}),0===t.length?void alert("Choose the colors and their positions first."):void $.ajax({type:"post",url:"/site/ajax-submit-guess",data:{idGame:a,idPlayer:e,guess:t},complete:function(a){$("#btnSubmitGuess").hide(),$("#btnSubmitGuessMsg").show()}})}var socket=io.connect(websocketAddress);$(document).ready(function(){checkPlayer(),$("#btnHostGame").click(function(){$("#divGameSettings").removeClass("hidden").addClass("animated fadeIn")}),$("#btnCreateGame").click(function(){createNewGame()}),$("#btnJoinGame").click(function(){joinExistingGame()}),$("#divGamesList").on("click",".btn-join-game",function(){var a=$(this).data("id");joinThisGame(a)}),$("#divGameRoom").on("click",".btn-player-ready",function(){var a=$(this).data("idgame"),e=$(this).data("idplayer");setPlayerStatus(a,e,"ready")}),$("#divGameBoard").on("click","#btnSubmitGuess",function(){var a=$(this).data("idgame"),e=$(this).data("idplayer");submitGuess(a,e)}),$("#login-form").submit(function(){var a=$(this);return $.ajax({url:a.attr("action"),type:"post",data:a.serialize(),success:function(){document.location.reload()}}),!1})});