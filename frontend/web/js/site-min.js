function checkPlayer(){""===token?$("#divLogin").removeClass("hidden").addClass("animated fadeIn"):$("#divNewGameJoinGame").removeClass("hidden").addClass("animated fadeIn")}function subscribePlayer(e){socket.emit("subscribe","game"+e),socket.on("game"+e,function(e){var a;try{a=JSON.parse(e)}catch(t){a=e}console.log(a),"startgame"==a.task?startGame(a.idGame):"update-room"==a.task?updateGameRoom(a.idGame):"all-players-ready"==a.task&&(updateGameRoom(a.idGame),updateGameBoard(a.idGame))}),console.log("Player subscribed to channel: game"+e)}function startGame(e){console.log("Starting game "+e),$("#divGameRoom").addClass("hidden").removeClass("animated slideInLeft"),updateGameBoard(e)}function updateGameRoom(e){$("#divGameRoom").load("/site/ajax-update-game-room",{id:e},function(){$("#divGamesList").removeClass("animated slideInLeft fadeIn").addClass("hidden"),$(this).removeClass("hidden").addClass("animated slideInLeft")})}function updateGameBoard(e){updateGameRoom(e),$("#divGameBoard").load("/site/ajax-get-game-board",{idGame:e},function(){$(this).removeClass("hidden").addClass("animated fadeIn")})}function createNewGame(){$.ajax({url:"/site/ajax-host-game",type:"post",dataType:"json",data:{secret_size:$("#secret_size").val()},success:function(e){$("#divGameSettings").addClass("hidden").removeClass("animated fadeIn"),subscribePlayer(e.id_game),updateGameRoom(e.id_game),console.log("Player "+token+" joinned game "+e.id_game)}})}function joinExistingGame(){$("#divGamesList").load("/site/ajax-games-list",function(){$(this).removeClass("slideInLeft fadeIn").removeClass("hidden").addClass("animated slideInLeft")}),$("#divGameRoom").addClass("hidden")}function joinThisGame(e){subscribePlayer(e),$.post("/site/ajax-join-game",{idGame:e},function(a){updateGameRoom(e),socket.emit("player-joinned-game",e)}),console.log("Player "+token+" joinned game "+e)}function setPlayerStatus(e,a,t){$.ajax({type:"post",url:"/site/ajax-set-player-status",data:{idGame:e,idPlayer:a,status:t},complete:function(a){updateGameRoom(e)}})}function submitGuess(e,a){var t=[];$(".color-picker").each(function(e,a){t.push($(a).val())}),$.ajax({type:"post",url:"/site/ajax-submit-guess",data:{idGame:e,idPlayer:a,guess:t},complete:function(a){updateGameRoom(e),updateGameBoard(e),$("#btnSubmitGuess").hide(),$("#btnSubmitGuessMsg").show()}})}var socket=io.connect(websocketAddress);$(document).ready(function(){checkPlayer(),$("#btnHostGame").click(function(){$("#divGameSettings").removeClass("hidden").addClass("animated fadeIn")}),$("#btnCreateGame").click(function(){createNewGame()}),$("#btnJoinGame").click(function(){joinExistingGame()}),$("#divGamesList").on("click",".btn-join-game",function(){var e=$(this).data("id");joinThisGame(e)}),$("#divGameRoom").on("click",".btn-player-ready",function(){var e=$(this).data("idgame"),a=$(this).data("idplayer");setPlayerStatus(e,a,"ready")}),$("#divGameBoard").on("click","#btnSubmitGuess",function(){var e=$(this).data("idgame"),a=$(this).data("idplayer");submitGuess(e,a)}),$("#login-form").submit(function(){var e=$(this);return $.ajax({url:e.attr("action"),type:"post",data:e.serialize(),success:function(){document.location.reload()}}),!1})});